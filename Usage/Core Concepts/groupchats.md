# 群聊

### 回复顺序策略

决定群聊中角色的回复顺序。

#### 自然顺序

尝试模拟真实人类对话的流动。算法如下：

1. 从聊天中的最后一条消息中提取群组成员名称的提及。

只有完整的单词被识别为提及！如果你的角色名字是“御坂美琴”，他们只会在提及“御坂”或“美琴”时回复，而不会对“Misa”、“电击”等作出回应。

除非启用了“允许自我回应”设置，否则角色不会对自己消息中提及的名字作出回复！

2. 角色通过“健谈度”因素被激活。

健谈度定义了角色在未被提及时说话的频率。在角色编辑器的“高级定义”屏幕上调整此值。滑块值在**0% / 害羞**（角色除非被提及，否则从不说话）到**100% / 健谈**（角色总是回复）之间呈线性比例。新角色的默认值为50%的机会。

3. 随机选择一个角色。

如果在前面的步骤中没有激活任何角色，则随机选择一个发言者，忽略所有其他条件。

#### 列表顺序

角色根据在群组成员列表中的顺序进行排列。没有其他规则适用。

### 群组生成处理模式

此设置决定如何处理群聊成员的角色信息。无论选择什么，群聊历史始终在所有成员之间共享。

#### 交换角色卡片

默认模式。每次生成消息时，仅包含当前发言者的角色卡片信息。

#### 加入角色卡片

所有群组成员的信息（如果他们不是当前发言者，则不包括静音的成员）按列表顺序合并为一个。这在不希望大幅改变上下文的情况下会有所帮助，例如在使用 llama.cpp 时。

以下字段被合并：

1. 描述
2. 场景，如果未为聊天覆盖
3. 个性
4. 消息示例
5. 角色备注 / 深度提示

**重要！** 请注意，由于典型角色卡片的结构，使用此模式可能会导致意想不到的行为，包括但不限于：角色对自己感到困惑、个性合并、不确定的特征等。

### 其他群聊菜单选项

#### 静音角色

群聊菜单中角色头像旁边的划线对话气泡图标可以禁用或启用特定角色在聊天中的回复。

#### 强制发言

群聊菜单中角色头像旁边的对话气泡图标将仅触发特定角色的回复，绕过回复顺序策略。即使该群成员被静音，它也会工作。

#### 自动模式

当启用自动模式时，群聊将遵循回复顺序，并在没有用户交互的情况下触发消息生成。当最后一个草拟角色发送其消息后，下一次自动模式转发将在5秒延迟后触发。当用户开始在发送消息文本区域输入时，自动模式将被禁用，但已经排队的生成不会自动停止。

#### 允许自我回复

如果在选择自然顺序时由于自我提及而触发，允许连续回复最近发送消息的角色。对列表顺序没有影响。

#### 群聊场景覆盖

所有群成员将使用输入的场景文本，而不是他们角色卡中指定的内容。分支聊天从其父级继承场景覆盖，之后可以单独更改。

#### 查看角色定义

点击群聊菜单中头像旁的角色卡图标将快速导航到通常的角色定义屏幕。在这里所做的任何更改将保存到卡片本身。

要返回群聊，请点击群名称标题链接。

#### 成员管理

您现有的任何角色都可以在群聊中添加、移除、静音或重新排序。默认情况下，新成员会被添加到群成员列表的顶部，然后可以使用箭头图标重新排序。

#### 群聊弹出窗口

通过点击“当前成员”字段旁的图标可以激活群聊菜单弹出窗口。这会创建一个群聊菜单的弹出窗口。通过在用户设置中启用MovingUI，该菜单可以调整大小并拖动到界面的任何位置，并且功能与常规群聊菜单相同。